<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>英単語クロース練習アプリ（Lesson 1–6）</title>
<style>
  :root {
    --bg: #f7f9fc; --panel:#ffffff; --muted:#6b7280; --text:#0f172a; --accent:#2563eb;
    --ok:#059669; --bad:#dc2626; --chip:#eef2ff; --ring:#e5e7eb;
  }
  html, body { height: 100%; }
  body { margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Sans", "Noto Sans JP", sans-serif; color: var(--text); background: linear-gradient(#fff, var(--bg)); }
  .container { max-width: 900px; margin: 0 auto; padding: 24px; }
  header { display:flex; align-items:center; justify-content:space-between; gap: 16px; margin-bottom:16px; }
  h1 { font-size: 22px; margin: 0; }
  .stats { color: var(--muted); font-size: 13px; }
  .card { background: var(--panel); border: 1px solid var(--ring); border-radius: 16px; box-shadow: 0 6px 16px rgba(15,23,42,.06); padding: 20px; }
  .row { display:flex; flex-wrap:wrap; gap: 10px; align-items:center; }
  .row + .row { margin-top: 12px; }
  label { font-size: 13px; color: var(--muted); }
  select, input[type="text"] { border: 1px solid var(--ring); border-radius: 12px; padding: 10px 12px; font-size: 16px; }
  button { border: 1px solid var(--ring); background: #fff; border-radius: 12px; padding: 9px 12px; font-size: 14px; cursor: pointer; transition: .15s ease; }
  button:hover { transform: translateY(-1px); box-shadow: 0 6px 12px rgba(0,0,0,.06); }
  .btn-primary { background: var(--accent); color: #fff; border-color: var(--accent); }
  .btn-ghost { background: #fff; }
  .btn-danger { border-color: #fca5a5; background: #fff5f5; }
  .hint { color: var(--muted); font-size: 13px; }
  rt { font-size: 10px; color: #666; }
  ruby { ruby-position: over; }
  .cloze { font-size: clamp(20px, 3.2vw, 28px); font-weight: 600; background: #f3f4f6; border-radius: 16px; padding: 16px; line-height: 1.5; }
  .judge { min-height: 24px; font-size: 14px; font-weight: 600; }
  .ok { color: var(--ok); }
  .bad { color: var(--bad); }
  .footer { margin-top: 16px; text-align:center; font-size: 12px; color: var(--muted); }
  .kbd { background: #f3f4f6; border: 1px solid var(--ring); border-bottom-width: 3px; border-radius: 8px; padding: 2px 8px; font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size: 12px; }
  .divider { height:1px; background: var(--ring); margin: 10px 0; }
  .accept { font-size: 12px; color: var(--muted); word-break: break-word; }
  .tiny { font-size: 12px; color: var(--muted); }
</style>
</head>
<body>
  <div class="container">
    <header>
      <h1>英単語クロース練習アプリ</h1>
      <div id="stats" class="stats">読み込み中…</div>
    </header>

    <div class="card">
      <div class="row">
        <div class="row" style="gap:8px; align-items:center;">
          <label for="lesson">レッスン</label>
          <select id="lesson"></select>
        </div>
        <div class="row" style="margin-left:auto; gap:8px;">
          <button id="btn-shuffle" class="btn-ghost" title="順番をランダム化">シャッフル</button>
          <button id="btn-hint" class="btn-ghost" title="日本語ヒントのON/OFF">和訳ヒント OFF</button>
          <button id="btn-reset" class="btn-danger" title="このレッスンの成績をリセット">成績リセット</button>
        </div>
      </div>

      <div class="tiny">文中の該当語を自動で「____」に置換します。日本語ヒントでは漢字にふりがなが付きます。</div>

      <div class="row">
        <div id="cloze" class="cloze">—</div>
      </div>
      <div id="hint" class="hint" style="display:none;">ヒント（日）：—</div>

      <div class="row">
        <input id="answer" type="text" placeholder="英単語（例: brings back / acted out など）" style="flex:1 1 320px" />
        <button id="btn-check" class="btn-primary">判定</button>
        <button id="btn-reveal" class="btn-ghost">答えを表示</button>
        <button id="btn-next" class="btn-ghost">次へ</button>
      </div>

      <div id="judge" class="judge"></div>
      <div class="accept" id="accept">受け付ける答え：—</div>

      <div class="divider"></div>
      <div class="row" style="justify-content:space-between; color: var(--muted); font-size:13px;">
        <div id="position">—</div>
        <div><span class="kbd">Enter</span> で判定</div>
      </div>
    </div>

    <div class="footer">データの編集はHTML末尾の <code>LESSONS</code> を更新してください。</div>
  </div>

<script>
const LESSONS = { /* データは省略（前と同じ） */ };

function kanaize(text){
  return text
    .replace(/俳優/g,'<ruby>俳優<rt>はいゆう</rt></ruby>')
    .replace(/舞台/g,'<ruby>舞台<rt>ぶたい</rt></ruby>')
    .replace(/記憶/g,'<ruby>記憶<rt>きおく</rt></ruby>')
    .replace(/言語/g,'<ruby>言語<rt>げんご</rt></ruby>')
    .replace(/階/g,'<ruby>階<rt>かい</rt></ruby>')
    .replace(/服/g,'<ruby>服<rt>ふく</rt></ruby>')
    .replace(/床/g,'<ruby>床<rt>ゆか</rt></ruby>')
    .replace(/掴/g,'<ruby>掴<rt>つか</rt></ruby>')
    .replace(/場面/g,'<ruby>場面<rt>ばめん</rt></ruby>')
    .replace(/階段/g,'<ruby>階段<rt>かいだん</rt></ruby>')
    .replace(/登場人物/g,'<ruby>登場人物<rt>とうじょうじんぶつ</rt></ruby>')
    .replace(/状況/g,'<ruby>状況<rt>じょうきょう</rt></ruby>')
    .replace(/技術/g,'<ruby>技術<rt>ぎじゅつ</rt></ruby>')
    .replace(/文化/g,'<ruby>文化<rt>ぶんか</rt></ruby>')
    .replace(/娘/g,'<ruby>娘<rt>むすめ</rt></ruby>')
    .replace(/奴隷/g,'<ruby>奴隷<rt>どれい</rt></ruby>')
    .replace(/大陸/g,'<ruby>大陸<rt>たいりく</rt></ruby>')
    .replace(/証拠/g,'<ruby>証拠<rt>しょうこ</rt></ruby>')
    .replace(/結果/g,'<ruby>結果<rt>けっか</rt></ruby>')
    .replace(/驚/g,'<ruby>驚<rt>おどろ</rt></ruby>')
    .replace(/地震/g,'<ruby>地震<rt>じしん</rt></ruby>')
    .replace(/説明/g,'<ruby>説明<rt>せつめい</rt></ruby>')
    .replace(/建物/g,'<ruby>建物<rt>たてもの</rt></ruby>')
    .replace(/発表/g,'<ruby>発表<rt>はっぴょう</rt></ruby>')
    .replace(/計画/g,'<ruby>計画<rt>けいかく</rt></ruby>')
    .replace(/安全/g,'<ruby>安全<rt>あんぜん</rt></ruby>')
    .replace(/信号/g,'<ruby>信号<rt>しんごう</rt></ruby>')
    .replace(/警告/g,'<ruby>警告<rt>けいこく</rt></ruby>');
}

function renderHint(text){ return 'ヒント（日）：' + kanaize(text); }

function render(){
  const cur = LESSONS[state.lesson][state.index];
  const hint = $('#hint');
  hint.style.display = state.showHint ? '' : 'none';
  hint.innerHTML = renderHint(cur.jp);
}
</script>
</body>
</html>
